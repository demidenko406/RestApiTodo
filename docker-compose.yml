version: "3"
services:
    nginx: 
      restart: unless-stopped
      image: restapitodo_backend:latest
      ports:
          - 80:80
      volumes:
          - static_volume:/app/backend/server/django_static
          - ./nginx/:/etc/nginx/conf.d
      depends_on: 
          - backend
    backend:
      restart: unless-stopped
      build:
          context: .
          dockerfile: ./backend/Dockerfile
      entrypoint: /app/backend/entrypoint.sh
      volumes:
          - static_volume:/app/backend/django_static
      expose:
          - 8000
    db:
      image: postgres:12.0-alpine
      volumes:
        - ./postgres_data/:/var/lib/postgresql/data/
      environment:
        - POSTGRES_DB=todolist
        - POSTGRES_USER=kalacey412
        - POSTGRES_PASSWORD=kalaceydb412
volumes:
    static_volume: {}
    postgres : {}

  